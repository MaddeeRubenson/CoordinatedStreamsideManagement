"0","if(is.null(unique_stns)) {"
"0","  map <- leaflet(SIA) %>%"
"0","  addPolygons(data = SIA, "
"0","              stroke = FALSE,"
"0","              fillOpacity = 0.2,"
"0","              smoothFactor = 0.5,"
"0","              fillColor = 'blue',"
"0","              popup = SIA@data$HU12_Name,"
"0","              group = ""SIA Boundary"") %>%"
"0","  addTiles() %>%"
"0","  addMarkers(data = all_stn_sp, "
"0","             lng = all_stn_sp@coords[,1], "
"0","             lat = all_stn_sp@coords[,2], "
"0","             popup = paste(""<style> div.leaflet-popup-content {width:auto !important;}</style>"","
"0","                           lapply(rownames(all_stn_sp@data),"
"0","                                  function(row) {"
"0","                                    htmlTable::htmlTable(all_stn_sp@data[row,],"
"0","                                                         header = c('Stn_ID', 'Stn_Name',"
"0","                                                                    names(all_stn_sp@data)[-c(1,2)]),"
"0","                                                         rnames = FALSE)"
"0","                                  })),"
"0","             group = 'All Stations Queried') %>%"
"0","  addWMSTiles('https://raster.nationalmap.gov/arcgis/services/LandCover/USGS_EROS_LandCover_NLCD/MapServer/WMSServer?',"
"0","              group = ""Land Use (NLCD 2011)"","
"0","              layers = '33',"
"0","              options = WMSTileOptions(format = 'image/png',"
"0","                                       version = '1.3.0',"
"0","                                       transparent = TRUE)) %>% "
"0","  hideGroup('Land Use (NLCD 2011)') %>%"
"0","  addWMSTiles(GetURL(""USGSTopo""), "
"0","              attribution = paste0(""<a href='https://www.usgs.gov/'>"","
"0","                                   ""U.S. Geological Survey</a> | "","
"0","                                   ""<ahref='https://www.usgs.gov/laws/policies_notices.html'>"","
"0","                                   ""Policies</a>""),"
"0","              group = ""USGS Topo"", layers = ""0"") %>%"
"0","  addWMSTiles(GetURL(""USGSHydroCached""), "
"0","              group = ""Hydrography"", "
"0","              options = WMSTileOptions(format = ""image/png"", "
"0","                                       transparent = TRUE),"
"0","              layers = ""0"") %>%"
"0","  hideGroup(""Hydrography"") %>%"
"0","  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%"
"0","  addLayersControl(baseGroups = c('Land Use (NLCD 2011)', 'USGS Topo', 'ESRI NatGEO World Map'),"
"0","                   overlayGroups = c(""SIA Boundary"", ""All Stations Queried"", ""Hydrography""),"
"0","                   options = layersControlOptions(collapsed = FALSE))"
"0","} else {"
"0","map <- leaflet(SIA) %>%"
"0","  addPolygons(data = SIA, "
"0","              stroke = FALSE,"
"0","              fillOpacity = 0.2,"
"0","              smoothFactor = 0.5,"
"0","              fillColor = 'blue',"
"0","              popup = SIA@data$HU12_Name,"
"0","              group = ""SIA Boundary"") %>%"
"0","  addTiles() %>%"
"0","  addMarkers(data = all.sp, "
"0","             lng = all.sp@coords[,1], "
"0","             lat = all.sp@coords[,2], "
"0","             popup = paste(""<style> div.leaflet-popup-content {width:auto !important;}</style>"","
"0","                           lapply(rownames(all.sp@data), "
"0","                                  function(row) {"
"0","                                    htmlTable::htmlTable(all.sp@data[row,],"
"0","                                                         header = c('Stn_ID', 'Stn_Name',"
"0","                                                                    names(all.sp@data)[-c(1,2)]),"
"0","                                                         rnames = FALSE)"
"0","                                  })),"
"0","             group = ""Stations that fit Criteria"") %>%"
"0","  addMarkers(data = all_stn_sp, "
"0","             lng = all_stn_sp@coords[,1], "
"0","             lat = all_stn_sp@coords[,2], "
"0","             popup = paste(""<style> div.leaflet-popup-content {width:auto !important;}</style>"","
"0","                           lapply(rownames(all_stn_sp@data),"
"0","                                  function(row) {"
"0","                                    htmlTable::htmlTable(all_stn_sp@data[row,],"
"0","                                                         header = c('Stn_ID', 'Stn_Name',"
"0","                                                                    names(all_stn_sp@data)[-c(1,2)]),"
"0","                                                         rnames = FALSE)"
"0","                                  })),"
"0","             group = 'All Stations Queried') %>%"
"0","  addWMSTiles('https://raster.nationalmap.gov/arcgis/services/LandCover/USGS_EROS_LandCover_NLCD/MapServer/WMSServer?',"
"0","              group = ""Land Use (NLCD 2011)"","
"0","              layers = '33',"
"0","              options = WMSTileOptions(format = 'image/png',"
"0","                                       version = '1.3.0',"
"0","                                       transparent = TRUE)) %>% "
"0","  hideGroup('Land Use (NLCD 2011)') %>%"
"0","  addWMSTiles(GetURL(""USGSTopo""), "
"0","              attribution = paste0(""<a href='https://www.usgs.gov/'>"","
"0","                                   ""U.S. Geological Survey</a> | "","
"0","                                   ""<ahref='https://www.usgs.gov/laws/policies_notices.html'>"","
"0","                                   ""Policies</a>""),"
"0","              group = ""USGS Topo"", layers = ""0"") %>%"
"0","  addWMSTiles(GetURL(""USGSHydroCached""), "
"0","              group = ""Hydrography"", "
"0","              options = WMSTileOptions(format = ""image/png"", "
"0","                                       transparent = TRUE),"
"0","              layers = ""0"") %>%"
"0","  hideGroup(""Hydrography"") %>%"
"0","  addProviderTiles(providers$Esri.NatGeoWorldMap) %>%"
"0","  addLayersControl(baseGroups = c('Land Use (NLCD 2011)', 'USGS Topo', 'ESRI NatGEO World Map'),"
"0","                   overlayGroups = c(""SIA Boundary"", 'Stations that fit Criteria', ""All Stations Queried"", ""Hydrography""),"
"0","                   options = layersControlOptions(collapsed = FALSE))"
"0","}"
"0","map"
